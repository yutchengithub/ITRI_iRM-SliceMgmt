
<div class="ocloudInfo">
	<h5>
    <button (click)="back()">
      <span class="material-icons">arrow_back</span>Back
    </button>
    {{languageService.i18n['field.info']}} – {{fieldName}}
  </h5>
	<!-- Field Map (場域地圖) -->
	<div>
		<!-- @12/13 Add the window of gNB List -->
		<div class="BOX mapWindow">
			<label class="boxTitle boxTitleRightAligned">
				<span class="title-container" *ngIf="showMapModel">{{ languageService.i18n['field.Map'] }}</span>
				<span class="title-container" *ngIf="!showMapModel">{{ languageService.i18n['field.bsList'] }}</span>

				<!-- 按鈕容器，根據 showMapModel 的值顯示或隱藏按鈕 -->
				<div class="fieldMap-button-container">
					<!-- 如非地圖模式，就隱藏 @12/13 ADD *ngIf="showMapModel -->
					<button mat-button *ngIf="showMapModel" [class.button-active]="activeButton_fieldImage === 'fieldImage'" (click)="setActiveButton_fieldImage('fieldImage')">
						<mat-icon>photo_camera_back</mat-icon>
						{{ languageService.i18n['field.image'] }}
					</button>
					<!-- 如非地圖模式，就隱藏 @12/13 ADD *ngIf="showMapModel -->
					<button mat-button *ngIf="showMapModel" [class.button-active]="activeButton_NR === 'NR'" (click)="setActiveButton_NR('NR')">
						<mat-icon>timeline</mat-icon>
						NR
					</button>
					<!-- 如非地圖模式，就隱藏 @12/13 ADD *ngIf="showMapModel --> 
					<button mat-button *ngIf="showMapModel" [class.button-active]="currentColorbar === 'RSRP'" (click)="toggleColorbar('RSRP')">
						<mat-icon>signal_cellular_alt</mat-icon>
						{{ languageService.i18n['field.rsrpMap'] }}
					</button>
					<!-- 如非地圖模式，就隱藏 @12/13 ADD *ngIf="showMapModel -->
					<button mat-button *ngIf="showMapModel" [class.button-active]="currentColorbar === 'SINR'" (click)="toggleColorbar('SINR')">
						<mat-icon>signal_cellular_alt</mat-icon>
						{{ languageService.i18n['field.sinrMap'] }}
					</button>
					  
					<!-- @12/12 Add button with a menu -->
					<!--　常駐顯示 -->
					<button mat-icon-button [matMenuTriggerFor]="menu" aria-label="icon-button with a menu" tooltip="{{ languageService.i18n['field.MapOption'] }}"
					[class.button-active]="activeButton_menu === 'menu'" (click)="setActiveButton_menu('menu')">
						<mat-icon>more_horiz</mat-icon>
					  </button>
					  <mat-menu #menu="matMenu" >

						<!-- Field Configuration -->
						<button mat-menu-item disabled>
							<mat-icon>build_circle</mat-icon>
							<span>{{ languageService.i18n['field.config'] }}</span>
						</button>
						<button mat-menu-item>
							<mat-icon></mat-icon>
							<span>{{ languageService.i18n['field.config'] }}</span>
						</button>
						<button mat-menu-item>
							<mat-icon></mat-icon>
							<span>{{ languageService.i18n['field.configPMset'] }}</span>
						</button>

						<!-- Field Reports -->
						<button mat-menu-item disabled>
						  <mat-icon>report</mat-icon>
						  <span>{{ languageService.i18n['field.report'] }}</span>
						</button>
						<button mat-menu-item>
							<mat-icon></mat-icon>
							<span>{{ languageService.i18n['field.reportPM'] }}</span>
						</button>
						<button mat-menu-item (click)="goFaultMgr()"><!-- @12/13 Add click goFaultMgr() -->
							<mat-icon></mat-icon>
							<span>{{ languageService.i18n['field.reportFM'] }}</span>
						</button>

						<!-- Field Optimization -->
						<button mat-menu-item disabled>
						  <mat-icon>settings_suggest</mat-icon>
						  <span>{{ languageService.i18n['field.optim'] }}</span>
						</button>
						<button mat-menu-item>
							<mat-icon></mat-icon>
							<span>{{ languageService.i18n['field.optimSON'] }}</span>
						</button>

						<!-- 當 showMapModel 為 true 時顯示 gNB 列表按鈕 @12/13 Add -->
						<button mat-menu-item *ngIf="showMapModel" (click)="toggleMenuButton()">
							<mat-icon svgIcon="BaseStation" class="svg-icon_BS"></mat-icon>
							<span>{{ languageService.i18n['field.bsList'] }}</span>
						</button>

						<!-- 當 showMapModel 為 false 時顯示地圖模式按鈕 @12/13 Add -->
						<button mat-menu-item *ngIf="!showMapModel" (click)="toggleMenuButton()">
							<mat-icon>place</mat-icon>
							<span>{{ languageService.i18n['field.mapModel'] }}</span>
						</button>

					  </mat-menu>
				</div>
			</label>

			<!-- 場域地圖只有當 showMapModel 為 true 時才顯示 -->
			<google-map *ngIf="showMapModel" width="915px" height="748px" 
						[center]="center" 
						[zoom]="zoom" 
						[options]="mapOptions">
			</google-map>

			<!-- 基站列表，只有當 showMapModel 為 false 時才顯示 -->
			<div *ngIf="!showMapModel">
				<!-- 基站列表 (還未實際接 api 值) @12/13 Add by yuchen -->
				<div class="table">
					<table class="center">
						<thead>
							<tr>
								<th>{{ languageService.i18n['field.gNBname'] }}</th>
								<th>{{ languageService.i18n['field.gNBtype'] }}</th>
								<th>{{ languageService.i18n['field.bsAntennaCoord'] }}</th>
								<th>{{ languageService.i18n['field.gNBstatus'] }}</th>
								<th>{{ languageService.i18n['field.view'] }}</th>
								<th>{{ languageService.i18n['field.bsAlarm'] }}</th>
							</tr>
						</thead>
						<tbody>
							<!-- <tr /**ngFor="let opt of msgToDisplay" >
                  <td>{{opt.fieldName}}</td>
                  <td>{{opt.bsName}}</td>
                  <td>{{opt.compname}}</td>
                </tr> -->
							<tr>
								<td>BS01</td>
								<td>All-in-one: [CU + DU + RU]</td>
								<td>[121.044029,24.773652]</td>
								<td class="icon">
									<!-- <label *ngIf="opt.status === 0" class="greenLight"></label> -->
									<!-- <label *ngIf="opt.status === 1" class="redLight"></label> -->
									<label class="greenLight"></label>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.view'] }}">remove_red_eye</mat-icon>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.bsAlarm'] }}">warning</mat-icon>
								</td>
							</tr>
							<tr>
								<td>BS02</td>
								<td>Disaggregated: [CU] + [DU] + [RU]</td>
								<td>[121.044029,24.773652]</td>
								<td>
									<label class="redLight"></label>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.view'] }}">remove_red_eye</mat-icon>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.bsAlarm'] }}">warning</mat-icon>
								</td>
							</tr>
							<tr>
								<td>BS03</td>
								<td>Disaggregated: [CU] + [DU] + [RU]</td>
								<td>[121.044324,24.773815]</td>
								<td>
									<label class="greenLight"></label>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.view'] }}">remove_red_eye</mat-icon>
								</td>
								<td>
									<mat-icon tooltip="{{ languageService.i18n['field.bsAlarm'] }}">warning</mat-icon>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div id="ColorBar" style="margin-top: -10px; ">
			<ul *ngIf="currentColorbar === 'RSRP'">
				<div> <span class="colorbar-title">RSRP</span> <img src="assets/img/rsrp_colorbar.png">
					<!-- RSRP Colorbar -->
					<div class="RSRP_values"> <span>-130</span> <span>-120</span> <span>-110</span> <span>-100</span> <span>-90</span> <span>-80</span> </div>
				</div>
			</ul>
			<ul *ngIf="currentColorbar === 'SINR'">
				<div> <span class="colorbar-title">SINR</span> <img src="assets/img/rsrp_colorbar.png">
					<!-- SINR Colorbar -->
					<div class="SINR_values"> <span>-10</span> <span>0</span> <span>10</span> <span>20</span> <span>30</span> </div>
				</div>
			</ul>
		</div>
	</div>
	<div>
		<!-- Field Alarms Information (場域告警資訊) -->
		<div class="BOX col-md-4 center">
			<label class="boxTitle">{{ languageService.i18n['field.faultInfo'] }}
				<a href="javascript:void(0)" (click)="goFaultMgr()"> <span class="material-icons" tooltip="{{languageService.i18n['index.viewMore']}}">more_horiz</span> </a>
			</label>
			<div class="percent {{severityText_forCSS(severity)}} Fault" *ngFor="let severity of severitys; let i = index"> {{ severityText(severity) }}
				<br>{{ severityCount(severity) }} </div>
		</div>

		<!-- Field Performance Information (場域效能資訊) -->
		<div class="BOX performanceWindow cpu">
			<label class="boxTitle">{{languageService.i18n['field.performanceInfo']}}
				<a href="javascript:void(0)" (click)="goPerformanceMgr()"> <span class="material-icons" tooltip="{{languageService.i18n['index.viewMore']}}">more_horiz</span> </a>
			</label>
			<div class="performance_percent">
				<div class="item">
					<!-- @12/10 update to get fieldInfo.handoverRate -->
					<div class="label-container">
						<label>{{ languageService.i18n['field.handoverRate'] }}</label>
					</div>
					<circle-progress [percent]="coverageAsNumber" [subtitle]="coverageAsNumber + '%'"></circle-progress>
				</div>
				<div class="item">
					<!-- @12/10 update to get fieldInfo.accessibility -->
					<div class="label-container">
						<label>{{ languageService.i18n['field.accessRate'] }}</label>
					</div>
					<circle-progress [percent]="accessibilityAsNumber" [subtitle]="accessibilityAsNumber + '%'"></circle-progress>
				</div>
				<div class="item">
					<!-- @12/10 update to get fieldInfo.utilization.resourceProcess -->
					<div class="label-container">
						<label>{{ languageService.i18n['field.CPU_Utilization'] }}</label>
					</div>
					<circle-progress [percent]="resourceProcessAsNumber" [subtitle]="resourceProcessAsNumber + '%'"></circle-progress>
				</div>
				<div class="item">
					<!-- @12/10 update to get fieldInfo.utilization.resourceMemory -->
					<div class="label-container">
						<label>{{ languageService.i18n['field.Memory_Utilization'] }}</label>
					</div>
					<circle-progress [percent]="resourceMemoryAsNumber" [subtitle]="resourceMemoryAsNumber + '%'"></circle-progress>
				</div>
			</div>
		</div>

		<!-- gNB Detailed Information (基站資訊) -->
		<div class="BOX col-md-3 basicInfo bsWindow">
			<label class="boxTitle">{{languageService.i18n['field.bsInfo']}}</label>
			<ul>
				<li>
					<label>{{languageService.i18n['field.gNBname']}}</label><span>{{ocloudInfo.name}}</span></li>
				<li>
					<label>{{languageService.i18n['field.gNBtype']}}</label><span>{{ocloudInfo.id}}</span></li>
				<li>
					<label>NCI</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>PCI</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>PLMN ID</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>Tx Power (dBm)</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>NR-ARFCN-UL</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>NR-ARFCN-DL</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>{{languageService.i18n['field.Longitude']}}</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
				<li>
					<label>{{languageService.i18n['field.Latitude']}}</label><span>{{ocloudInfo.imsEndpoint}}</span></li>
			</ul>
			<div>
				<button mat-flat-button class="button-modifyConfiguration" tooltip="{{languageService.i18n['field.modifyConfiguration']}}" (click)="openUpdateModel()">{{languageService.i18n['field.modifyConfiguration']}}</button>
			</div>
			<div>
				<label class="boxTitle">{{languageService.i18n['field.neighboringBSList']}}</label>
				<!-- Neighboring gNB List @12/08 Add by yuchen -->
				<div class="table">
					<table>
						<thead>
							<tr>
								<th>PLMN ID</th>
								<th>NCI</th>
								<th>PCI</th>
							</tr>
						</thead>
						<tbody>
							<!-- <tr /**ngFor="let opt of msgToDisplay" >
                  <td>{{opt.fieldName}}</td>
                  <td>{{opt.bsName}}</td>
                  <td>{{opt.compname}}</td>
                </tr> -->
							<tr>
								<td>46655</td>
								<td>000004108</td>
								<td>100</td>
							</tr>
							<tr>
								<td>46655</td>
								<td>000050109</td>
								<td>101</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<ng-template #updateModal>
		<h5>{{languageService.i18n['software_update']}}</h5>
		<form [formGroup]="updateForm">
			<ul>
				<li>
					<label>Current Version</label> <span>{{ocloudInfo.softwareVersion}}</span> </li>
				<li>
					<label>Update Software</label> <span class="SoftwareUpdate">
          <mat-button-toggle-group formControlName="type" (change)="changeType($event)">
            <mat-button-toggle value="imageUrl">Image URL</mat-button-toggle>
            <mat-button-toggle value="existedFile">Existed File</mat-button-toggle>
          </mat-button-toggle-group>

          <div *ngIf="updateForm.controls['type'].value === 'imageUrl'">
            <input type="text" formControlName="imageUrl" placeholder="Image URL" class="{{formValidated&&updateForm.controls['imageUrl'].invalid?'required':''}}">
            <mat-error *ngIf="formValidated&&updateForm.controls['imageUrl'].invalid">Required</mat-error>
          </div>
          <div *ngIf="updateForm.controls['type'].value === 'existedFile'">
            <select formControlName="fileName" class="{{formValidated&&updateForm.controls['fileName'].invalid?'required':''}}">
              <option *ngFor="let opt of softwareList" [value]="opt.fileName">{{opt.fileName}}</option>
            </select>
            <mat-error *ngIf="formValidated&&updateForm.controls['fileName'].invalid">Required</mat-error>
            <div class="UV" *ngIf="updateForm.controls['type'].value === 'existedFile'">
              Update Version : {{softwareVersion()}}
            </div>
          </div>
        </span> </li>
			</ul>
			<div class="buttons">
				<button type="button" mat-dialog-close>Cancel</button>
				<button type="button" (click)="update()">OK</button>
			</div>
		</form>
	</ng-template>
